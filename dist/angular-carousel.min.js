/**
 * Angular Carousel - Mobile friendly touch carousel for AngularJS
 * @version v0.2.4 - 2014-07-25
 * @link http://revolunet.github.com/angular-carousel
 * @author Julien Bouquillon <julien@revolunet.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
angular.module("angular-carousel",["ngTouch"]);
angular.module("angular-carousel").directive("rnCarouselAutoSlide",["$timeout",function(c){return{restrict:"A",link:function(d,h,w){var z=Math.round(1E3*parseFloat(w.rnCarouselAutoSlide)),l=increment=!1,q=h.children().length;d.carouselExposedIndex||(d.carouselExposedIndex=0);stopAutoplay=function(){angular.isDefined(l)&&c.cancel(l);l=void 0};increment=function(){d.carouselExposedIndex=d.carouselExposedIndex<q-1?d.carouselExposedIndex+1:0};restartTimer=function(){stopAutoplay();l=c(increment,z)};d.$watch("carouselIndex",
function(){restartTimer()});restartTimer();w.rnCarouselPauseOnHover&&"false"!=w.rnCarouselPauseOnHover&&(h.on("mouseenter",stopAutoplay),h.on("mouseleave",restartTimer));d.$on("$destroy",function(){stopAutoplay();h.off("mouseenter",stopAutoplay);h.off("mouseleave",restartTimer)})}}}]);
angular.module("angular-carousel").directive("rnCarouselControls",[function(){return{restrict:"A",replace:!0,scope:{items:"=",index:"=",loop:"="},link:function(c,d,h){c.prev=function(){c.index=c.index?c.index-1:c.items.length};c.next=function(){c.index=(c.index+1)%c.items.length}},templateUrl:"carousel-controls.html"}}]);angular.module("angular-carousel").run(["$templateCache",function(c){c.put("carousel-controls.html",'<div class="rn-carousel-controls">\n  <span class="rn-carousel-control rn-carousel-control-prev" ng-click="prev();$event.stopPropagation();" ng-if="items.length > 1 && (index > 0  || loop)"></span>\n  <span class="rn-carousel-control rn-carousel-control-next" ng-click="next();$event.stopPropagation();" ng-if="items.length > 1 && (index < items.length - 1 || loop)"></span>\n</div>')}]);
angular.module("angular-carousel").directive("rnCarouselIndicators",[function(){return{restrict:"A",replace:!0,scope:{items:"=",index:"="},templateUrl:"carousel-indicators.html"}}]);angular.module("angular-carousel").run(["$templateCache",function(c){c.put("carousel-indicators.html",'<div class="rn-carousel-indicator">\n <span ng-repeat="item in items" ng-click="$parent.index=$index" ng-class="{active: $index==$parent.index}"></span>\n</div>')}]);
(function(){angular.module("angular-carousel").directive("rnCarousel",["$swipe","$window","$document","$parse","$compile","$rootScope",function(c,d,h,w,z,l){var q=0,G=d.requestAnimationFrame||d.webkitRequestAnimationFrame||d.mozRequestAnimationFrame;return{restrict:"A",scope:!0,compile:function(r,x){var H=r.children()[0].attributes,R=!1,S=!1,I=!1,T=angular.isDefined(x.rnCarouselLoop),m,J;r.addClass("rn-carousel-slides");r.children().addClass("rn-carousel-slide");["ng-repeat","data-ng-repeat","x-ng-repeat"].every(function(b){b=
H[b];if(angular.isDefined(b)){var c=b.value.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?\s*$/),d=c[3];m=c[1];J=c[2];if(m)return angular.isDefined(x.rnCarouselBuffered)&&(S=!0,b.value=m+" in "+J+"|carouselSlice:carouselBufferIndex:carouselBufferSize",d&&(b.value+=" track by "+d)),R=!0,!1}return!0});return function(b,r,f,A){function m(){for(var a=[],c=0;c<e;c++)a[c]=c;b.carouselIndicatorArray=a}function K(){B.css("width","100%");var a;a=t.children();(a=g=0===a.length?t[0].getBoundingClientRect().width:
a[0].getBoundingClientRect().width)&&B.css("width",a+"px")}function L(a){isNaN(a)&&(a=b.carouselIndex*g);n=a;a=-Math.round(n);a+=b.carouselBufferIndex*g;t[0].style[M]=V?"translate3d("+a+"px, 0, 0)":"translate("+a+"px, 0)"}function x(){var a;y&&(a=Date.now()-N,a=y*Math.exp(-a/75),3<a||-3>a?(L(u-a),G(x)):p(u/g))}function p(a,c){isNaN(a)&&(a=b.carouselIndex);if(c)n=a*g,C(null,null,!0);else{b.carouselIndex=a>=e?e:0>=a?0:a;var d=0,k=(b.carouselBufferSize-1)/2;S&&(d=b.carouselIndex<=k?0:e<b.carouselBufferSize?
0:b.carouselIndex>e-b.carouselBufferSize?e-b.carouselBufferSize:b.carouselIndex-k);b.carouselBufferIndex=d;"$apply"!==l.$$phase&&"$digest"!==l.$$phase&&(I?b.$apply():b.$digest());L()}}function O(a){D=!0;C({x:a.clientX,y:a.clientY},a)}function H(a,b){h.bind("mouseup",O);P=!0;Q=a.x;y=0;N=Date.now();return!1}function W(a,c){var d,k;P&&(d=a.x,k=Q-d,2<k||-2>k)&&(D=!0,Q=d,G(function(){var a=n+k;0===b.carouselIndex?a=Math.max(-(.05*g),a):b.carouselIndex===e-1&&(a=Math.min((e-1)*g+.05*g,a));L(a)}));return!1}
function C(a,c,d){if(!c||D){h.unbind("mouseup",O);D=P=!1;u=n;var k=.05*g;a=b.carouselIndex*g;var f=a-u;c=-Math[0<=f?"ceil":"floor"](f/g);k=Math.abs(f)>k;c+b.carouselIndex>=e&&(c=e-1-b.carouselIndex);0>c+b.carouselIndex&&(c=-b.carouselIndex);u=((k?c:0)+b.carouselIndex)*g;y=u-n;N=Date.now();d&&(y=n-a);G(x);return!1}}function E(){K();p()}q++;b.loop=T;var g,M,P,Q,y,n=0,u,e=0,D=!1,U=!0,N,t=r.wrap("<div id='carousel-"+q+"' class='rn-carousel-container'></div>"),B=t.parent();if(angular.isDefined(f.rnCarouselIndicator)||
angular.isDefined(f.rnCarouselControl))m(),b.$watch("carouselIndex",function(a){b.indicatorIndex=a;b.carouselExposedIndex=a}),b.$watch("indicatorIndex",function(a){p(a,!0)});angular.isDefined(f.rnCarouselPreventAnimation)&&(U=!1);b.$watch("carouselExposedIndex",function(a){p(a,!0)});angular.isDefined(f.rnCarouselIndicator)&&(A=z("<div id='carousel-"+q+"-indicator' index='indicatorIndex' items='carouselIndicatorArray' rn-carousel-indicators class='rn-carousel-indicator'></div>")(b),B.append(A));angular.isDefined(f.rnCarouselControl)&&
(A=z("<div id='carousel-"+q+"-controls' index='indicatorIndex' loop="+T+" items='carouselIndicatorArray' rn-carousel-controls class='rn-carousel-controls'></div>")(b),B.append(A));b.carouselBufferIndex=0;b.carouselBufferSize=5;b.carouselIndex=0;if(f.rnCarouselIndex){var v=w(f.rnCarouselIndex);angular.isFunction(v.assign)?(b.$watch("carouselIndex",function(a){v.assign(b.$parent,a)}),b.carouselIndex=v(b),b.$parent.$watch(v,function(a,c){void 0!==a&&(a>=e?(a=e-1,v.assign(b.$parent,a)):0>a&&(a=0,v.assign(b.$parent,
a)),p(a,U))}),I=!0):isNaN(f.rnCarouselIndex)||(b.carouselIndex=parseInt(f.rnCarouselIndex,10))}R?b.$watchCollection(J,function(a,c){e=0;angular.isArray(a)?e=a.length:angular.isObject(a)&&(e=Object.keys(a).length);m();g||K();p(b.carouselIndex)}):(e=r.children().length,m(),K());f.$observe("rnCarouselSwipe",function(a,b){"false"!==a&&"off"!==a?c.bind(t,{start:H,move:W,end:C,cancel:function(a){C({},a)}}):t.unbind()});I||p(b.carouselIndex);M="transform";["webkit","Moz","O","ms"].every(function(a){a+="Transform";
return"undefined"!==typeof document.body.style[a]?(M=a,!1):!0});var V=function(){var a=document.createElement("p"),b,c={webkitTransform:"-webkit-transform",msTransform:"-ms-transform",transform:"transform"};document.body.insertBefore(a,null);for(var d in c)void 0!==a.style[d]&&(a.style[d]="translate3d(1px,1px,1px)",b=window.getComputedStyle(a).getPropertyValue(c[d]));document.body.removeChild(a);return void 0!==b&&0<b.length&&"none"!==b}(),F=angular.element(d);F.bind("orientationchange",E);F.bind("resize",
E);b.$on("$destroy",function(){h.unbind("mouseup",O);F.unbind("orientationchange",E);F.unbind("resize",E)})}}}}])})();(function(){angular.module("angular-carousel").filter("carouselSlice",function(){return function(c,d,h){if(angular.isArray(c))return c.slice(d,d+h);if(angular.isObject(c))return c}})})();
